2025-11-03 17:29:02,036 - INFO - ================================================================================
2025-11-03 17:29:02,036 - INFO - Sepsis-3 Mortality Prediction Training Pipeline
2025-11-03 17:29:02,036 - INFO - ================================================================================
2025-11-03 17:29:02,036 - INFO - Random seed: 42
2025-11-03 17:29:02,036 - INFO - Output directory: outputs_final
2025-11-03 17:29:02,046 - INFO - Loading data from data/processed/sepsis3_cleaned.csv
2025-11-03 17:29:02,083 - INFO - Data loaded: 20391 samples, 27 features
2025-11-03 17:29:02,083 - INFO - Target distribution: 4703 positive (23.06%)
2025-11-03 17:29:02,083 - INFO - Splitting data (70/15/15 stratified)
2025-11-03 17:29:02,090 - INFO - Train: 14272 (70.0%)
2025-11-03 17:29:02,090 - INFO - Val: 3060 (15.0%)
2025-11-03 17:29:02,090 - INFO - Test: 3059 (15.0%)
2025-11-03 17:29:02,090 - INFO - Building preprocessing pipeline
2025-11-03 17:29:02,110 - INFO - Pipeline fitted: 27 numeric features
2025-11-03 17:29:02,110 - INFO - ============================================================
2025-11-03 17:29:02,110 - INFO - Stage A: Baseline Model Training
2025-11-03 17:29:02,110 - INFO - ============================================================
2025-11-03 17:29:02,110 - INFO - Training Logistic Regression...
2025-11-03 17:29:02,111 - WARNING - [WARNING] Logistic Regression failed: Input X contains NaN.
LogisticRegression does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-11-03 17:29:02,111 - INFO - Training Random Forest...
2025-11-03 17:29:02,586 - INFO - [OK] RF - AUC: 0.7909
2025-11-03 17:29:02,586 - INFO - Training XGBoost...
2025-11-03 17:29:03,386 - INFO - [OK] XGB - AUC: 0.7890
2025-11-03 17:29:03,386 - INFO - Training LightGBM...
2025-11-03 17:29:03,648 - INFO - [OK] LGB - AUC: 0.7755
2025-11-03 17:29:03,648 - INFO - Training Stacking Ensemble (LR, XGBoost, LightGBM)...
2025-11-03 17:29:03,651 - WARNING - [WARNING] Stacking failed: Input X contains NaN.
LogisticRegression does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-11-03 17:29:03,651 - INFO - [COMPLETE] Best baseline model: Random_Forest (AUC=0.7909)
2025-11-03 17:29:03,651 - INFO - Computing SHAP values...
2025-11-03 17:29:03,651 - INFO - Using 1000 samples for SHAP (for speed)
2025-11-03 17:29:11,259 - WARNING - [WARNING] SHAP computation failed: Per-column arrays must each be 1-dimensional
2025-11-03 17:29:11,260 - INFO - Plotting ROC and PR curves...
2025-11-03 17:29:11,624 - INFO - [OK] Saved: outputs_final/plots/roc_pr_curves.png
2025-11-03 17:29:11,624 - INFO - Plotting calibration curve...
2025-11-03 17:29:11,749 - INFO - [OK] Saved: outputs_final/plots/calibration_plot.png
2025-11-03 17:29:11,750 - INFO - Starting Optuna optimization (30 trials, xgb)
2025-11-03 17:29:48,620 - INFO - [OK] Optuna complete - Best AUC: 0.7965
2025-11-03 17:29:56,909 - INFO - Optimized model AUC: 0.7995
2025-11-03 17:29:56,967 - INFO - Optimizing classification thresholds...
2025-11-03 17:29:57,978 - INFO - [OK] Thresholds optimized - Youden: 0.2617, F2: 0.1364, Cost: 0.1485
2025-11-03 17:29:57,978 - INFO - Computing bootstrap confidence intervals (n=1000)
2025-11-03 17:29:59,130 - INFO - [OK] Bootstrap complete
2025-11-03 17:29:59,130 - INFO - Performing subgroup analysis...
2025-11-03 17:29:59,139 - INFO - [OK] Subgroup analysis complete (7 groups)
2025-11-03 17:29:59,139 - INFO - Plotting Decision Curve Analysis...
2025-11-03 17:29:59,299 - INFO - [OK] Saved: outputs_final/plots/dca_plot.png
2025-11-03 17:29:59,299 - INFO - ============================================================
2025-11-03 17:29:59,299 - INFO - Exporting Results and Artifacts
2025-11-03 17:29:59,299 - INFO - ============================================================
2025-11-03 17:29:59,300 - INFO - [OK] Saved: model_performance_summary.csv
2025-11-03 17:29:59,301 - INFO - [OK] Saved: threshold_optimization_report.csv
2025-11-03 17:29:59,301 - INFO - [OK] Saved: bootstrap_confidence_intervals.csv
2025-11-03 17:29:59,301 - INFO - [OK] Saved: subgroup_performance_table.csv
2025-11-03 17:29:59,301 - INFO - [OK] Saved: optuna_best_params.json
2025-11-03 17:29:59,328 - INFO - [OK] Saved: best_sepsis_model.pkl
2025-11-03 17:29:59,328 - INFO - [COMPLETE] All exports complete
2025-11-03 17:29:59,329 - INFO - ================================================================================
2025-11-03 17:29:59,329 - INFO - [COMPLETE] Pipeline finished in 57.29 seconds
2025-11-03 17:29:59,329 - INFO - Results saved to: outputs_final
2025-11-03 17:29:59,329 - INFO - ================================================================================
