2025-11-04 15:44:42,670 - INFO - ================================================================================
2025-11-04 15:44:42,671 - INFO - Sepsis-3 Mortality Prediction Training Pipeline
2025-11-04 15:44:42,671 - INFO - ================================================================================
2025-11-04 15:44:42,671 - INFO - Random seed: 42
2025-11-04 15:44:42,671 - INFO - Output directory: outputs_with_stacking_opt
2025-11-04 15:44:42,680 - INFO - Loading data from data/processed/sepsis3_cleaned.csv
2025-11-04 15:44:42,719 - INFO - Data loaded: 20391 samples, 27 features
2025-11-04 15:44:42,720 - INFO - Target distribution: 4703 positive (23.06%)
2025-11-04 15:44:42,720 - INFO - Splitting data (70/15/15 stratified)
2025-11-04 15:44:42,728 - INFO - Train: 14272 (70.0%)
2025-11-04 15:44:42,728 - INFO - Val: 3060 (15.0%)
2025-11-04 15:44:42,728 - INFO - Test: 3059 (15.0%)
2025-11-04 15:44:42,728 - INFO - Building preprocessing pipeline
2025-11-04 15:44:42,748 - INFO - Pipeline fitted: 27 numeric features
2025-11-04 15:44:42,748 - INFO - ============================================================
2025-11-04 15:44:42,748 - INFO - Stage A: Baseline Model Training
2025-11-04 15:44:42,748 - INFO - ============================================================
2025-11-04 15:44:42,748 - INFO - Preprocessing data for LR and Stacking models...
2025-11-04 15:44:42,754 - INFO - Training Logistic Regression...
2025-11-04 15:44:42,770 - INFO - [OK] LR - AUC: 0.7839
2025-11-04 15:44:42,770 - INFO - Training Random Forest...
2025-11-04 15:44:43,238 - INFO - [OK] RF - AUC: 0.7926
2025-11-04 15:44:43,238 - INFO - Training XGBoost...
2025-11-04 15:44:43,972 - INFO - [OK] XGB - AUC: 0.7925
2025-11-04 15:44:43,972 - INFO - Training LightGBM...
2025-11-04 15:44:44,236 - INFO - [OK] LGB - AUC: 0.7772
2025-11-04 15:44:44,236 - INFO - Training Stacking Ensemble (LR, XGBoost, LightGBM)...
2025-11-04 15:44:53,169 - INFO - [OK] Stack - AUC: 0.7968
2025-11-04 15:44:53,169 - INFO - [COMPLETE] Best baseline model: Stacking (AUC=0.7968)
2025-11-04 15:44:53,169 - INFO - Computing SHAP values...
2025-11-04 15:44:53,169 - INFO - Using 1000 samples for SHAP (for speed)
2025-11-04 15:44:53,169 - WARNING - SHAP not supported for this model type
2025-11-04 15:44:53,169 - INFO - Plotting ROC and PR curves...
2025-11-04 15:44:53,536 - INFO - [OK] Saved: outputs_with_stacking_opt/plots/roc_pr_curves.png
2025-11-04 15:44:53,536 - INFO - Plotting calibration curve...
2025-11-04 15:44:53,708 - INFO - [OK] Saved: outputs_with_stacking_opt/plots/calibration_plot.png
2025-11-04 15:44:53,709 - INFO - Best baseline model: Stacking (AUC=0.7968)
2025-11-04 15:44:53,709 - INFO - Adding Stacking to optimization queue (best or near-best baseline)
2025-11-04 15:44:53,709 - INFO - Optimizing stacking...
2025-11-04 15:44:53,709 - INFO - Starting Optuna optimization (40 trials, stacking)
2025-11-04 15:49:17,323 - INFO - [OK] Optuna complete - Best AUC: 0.7958
2025-11-04 15:49:50,813 - INFO - Optimized Stacking_Optimized AUC: 0.7999
2025-11-04 15:49:50,813 - INFO - Optimizing xgb...
2025-11-04 15:49:50,813 - INFO - Starting Optuna optimization (40 trials, xgb)
2025-11-04 15:50:31,371 - INFO - [OK] Optuna complete - Best AUC: 0.7984
2025-11-04 15:50:36,714 - INFO - Optimized XGBoost_Optimized AUC: 0.8033
2025-11-04 15:50:36,783 - INFO - Optimizing classification thresholds...
2025-11-04 15:50:37,868 - INFO - [OK] Thresholds optimized - Youden: 0.1849, F2: 0.1065, Cost: 0.1735
2025-11-04 15:50:37,868 - INFO - Computing bootstrap confidence intervals (n=1000)
2025-11-04 15:50:39,120 - INFO - [OK] Bootstrap complete
2025-11-04 15:50:39,120 - INFO - Performing subgroup analysis...
2025-11-04 15:50:39,129 - INFO - [OK] Subgroup analysis complete (7 groups)
2025-11-04 15:50:39,129 - INFO - Plotting Decision Curve Analysis...
2025-11-04 15:50:39,296 - INFO - [OK] Saved: outputs_with_stacking_opt/plots/dca_plot.png
2025-11-04 15:50:39,296 - INFO - ============================================================
2025-11-04 15:50:39,296 - INFO - Exporting Results and Artifacts
2025-11-04 15:50:39,296 - INFO - ============================================================
2025-11-04 15:50:39,297 - INFO - [OK] Saved: model_performance_summary.csv
2025-11-04 15:50:39,297 - INFO - [OK] Saved: threshold_optimization_report.csv
2025-11-04 15:50:39,297 - INFO - [OK] Saved: bootstrap_confidence_intervals.csv
2025-11-04 15:50:39,298 - INFO - [OK] Saved: subgroup_performance_table.csv
2025-11-04 15:50:39,298 - INFO - [OK] Saved: optuna_best_params.json
2025-11-04 15:50:39,329 - INFO - [OK] Saved: best_sepsis_model.pkl
2025-11-04 15:50:39,329 - INFO - [COMPLETE] All exports complete
2025-11-04 15:50:39,329 - INFO - ================================================================================
2025-11-04 15:50:39,329 - INFO - [COMPLETE] Pipeline finished in 356.66 seconds
2025-11-04 15:50:39,329 - INFO - Results saved to: outputs_with_stacking_opt
2025-11-04 15:50:39,329 - INFO - ================================================================================
